FROM freeradius/freeradius-server:3.2.4

# Habilitar módulo SQL
RUN ln -sf /etc/freeradius/mods-available/sql /etc/freeradius/mods-enabled/sql

# Habilitar site default
RUN ln -sf /etc/freeradius/sites-available/default /etc/freeradius/sites-enabled/default

# Copiar configurações customizadas
COPY freeradius/clients.conf /etc/freeradius/clients.conf
COPY freeradius/mods-available/sql /etc/freeradius/mods-available/sql
COPY freeradius/sites-available/default /etc/freeradius/sites-available/default

# Permissões corretas
RUN chown -R freerad:freerad /etc/freeradius

# Portas RADIUS
EXPOSE 1812/udp 1813/udp

# Executar em foreground (Docker-friendly)
CMD ["freeradius", "-f"]
